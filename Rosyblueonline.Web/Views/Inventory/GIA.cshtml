@{
    ViewBag.Title = "GIA";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
@section header{
    @Styles.Render("~/bundles/DataTable/Style")
}
<div class="content-wrapper">
    <div id="uiPanel1"></div>
    <section class="content">
        <div class="row">
            <div class="col-lg-12">
                <form id="frmGIAInventory">
                    <div class="col-lg-6 col-md-6 col-md-offset-3">
                        <div class="stock-box">
                            <div class="memo-title">
                                <h2>@Resource.GIA_Upload</h2>
                            </div>
                            <div class="dash-box">
                                <div class="dash-inner">
                                    <div class="customers-info">
                                        <div class="">
                                            <div class="form-group clearfix">
                                                <div class="col-lg-3"><label class="control-label">@Resource.Select_file_for_upload_GIA</label></div>
                                                <div class="col-lg-9">
                                                    <a href="/Content/INV/Temp/GIA_UploadFormat.xlsx">@Resource.Download_sample_file_for_upload1</a>
                                                </div>
                                            </div>
                                            <div class="form-group clearfix">
                                                <div class="col-lg-3"><label for="fuExcel" class="control-label">@Resource.Select_file</label></div>
                                                <div class="col-lg-9">
                                                    <input class="form-control" id="fuExcel" name="Excel" type="file">
                                                    <input type="hidden" name="Excel" value="@System.Configuration.ConfigurationManager.AppSettings["CertipAddress"]" id="hfIP" />
                                                </div>
                                            </div>
                                            <div class="form-group clearfix">
                                                <div class="col-lg-12">
                                                    <button class="btn btn-primary pull-right" id="btnSubmit" value="Update">
                                                        @Resource.Upload <i class="fa fa-upload"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12 col-md-12" id="pnlTable" style="display:none">
                        <div class="dash-box">
                            <div class="dash-inner">
                                <div>
                                    @*<button class="btn btn-primary" id="btnDownload"><i class="fa fa-download" aria-hidden="true"></i>Download</button>*@
                                    <div id="dvjson"></div>
                                </div>
                                <table id="myTable" class="table table-fixed dataTable no-footer customers-table">
                                    <thead class="bordertp">
                                        <tr role="row" class="table-head">
                                            <th>
                                                @Resource.Lot_Number
                                            </th>
                                            <th class="tbnew">
                                                @Resource.CERTIFICATE
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Shape
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Size
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Color
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Clarity
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Length
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Width
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Depth
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Cut Grade
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Lab
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Depth
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Table
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Girdle
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Polish
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Symmetry
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Fluorescence_Intensity
                                            </th>
                                            <th class="tbnew CrownHeight">
                                                @Resource.Crown_Height
                                            </th>
                                            <th class="tbnew cAngle">
                                                @Resource.Crown_Angle
                                            </th>
                                            <th class="tbnew PavilionDepth">
                                                @Resource.Pavilion_Depth
                                            </th>
                                            <th class="tbnew pAngle">
                                                @Resource.Pavilion_Angle
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Star_Length
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Lower_Half
                                            </th>
                                            <th class="tbnew girdle">
                                                @Resource.Girdle_Per
                                            </th>
                                            <th class="tbnew ReportDate">
                                                @Resource.Report_Date
                                            </th>
                                            <th class="tbnew">
                                                Culet_Size
                                            </th>
                                            <th class="tbnew">
                                                Inscription
                                            </th>
                                            <th class="tbnew">
                                                Key_to_Symbol
                                            </th>
                                            <th class="tbnew">
                                                Report_Comments
                                            </th>
                                            <th class="tbnew">
                                                @Resource.Status
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </form>


            </div>
        </div>
    </section>
</div>

@section script{
    @Scripts.Render("~/bundles/DataTable/Script")
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.1/xlsx.full.min.js"></script>
    <script type="text/javascript" src="~/Scripts/FileSaver.min.js"></script>
    <script type="text/javascript" src="~/Scripts/tableexport.min.js"></script>
    <script type="text/javascript" src="~/Scripts/custom/uiApp.js"></script>
    <script type="text/javascript" src="~/Scripts/custom/rbDataTable.js"></script>
    @*<script type="text/javascript" src="~/Scripts/custom/Controller/CtrlGIAUpload.js"></script>*@




    @*<script type="text/javascript">
        $(document).ready(function () {
            MenuName = "GIAReports";
            $.ajax({
                type: "POST",
                url: "/Home/PageAccessCheck",
                data: '{MenuName: "' + MenuName + '" }',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response.IsSuccess == true) {

                    } else {
                        $('#Modal-AccessDenied').modal('show');
                        uiApp.Alert({ container: '#uiPanel1', message: "You don't have a access of this page", type: "danger" });
                        setTimeout(function () {
                            location.href = '/Home/Index';
                        }, 1000);
                    }

                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (req, status, error) {
                    console.log(msg);
                }
            });
        });

    </script>*@


    <script type="text/javascript" language="javascript">
        var versionUpdate = (new Date()).getDate();
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "/Scripts/custom/Controller/CtrlGIAUpload.js?v=" + versionUpdate;
        document.body.appendChild(script);
    </script>
    <script>

        var appSetting = '@(System.Configuration.ConfigurationManager.AppSettings["WebsiteInspectAccess"].ToString())';
    //    alert(appSetting);
        var InspectBlock = true;
        var array = appSetting.split(",");
        $.each(array, function (i) {
            if (array[i] == $("#hfUserIds").val()) {
                InspectBlock = false;
            }

        });

        //alert($("#hfUserIds").val());
        if (InspectBlock == true) {
            document.addEventListener('contextmenu', event => event.preventDefault());
            document.onkeydown = function (e) {
                if (event.keyCode == 123) {
                    return false;
                }

                if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                    return false;
                }
                if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                    return false;
                }
                if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                    return false;
                }
                if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                    return false;
                }
                if (e.ctrlKey && e.keyCode == 'S'.charCodeAt(0)) {
                    return false;
                }

            }
        }


    </script>

}


